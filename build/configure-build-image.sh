#!/bin/bash
BUILDDIR=~/build
ISOLINUXDIR=$BUILDDIR/isolinux
mkdir -p $ISOLINUXDIR
cp /mnt/repodata/*comps.xml $BUILDDIR/comps.xml
mkdir -p $ISOLINUXDIR/{EXTRAS,images,isolinux,ks,LiveOS,Packages,repodata}
cp /mnt/TRANS.TBL $ISOLINUXDIR
cp /mnt/LiveOS/squashfs.img $ISOLINUXDIR/LiveOS
cp /mnt/isolinux/* $ISOLINUXDIR/isolinux
cp -r /mnt/images/* $ISOLINUXDIR/images
cp /mnt/.discinfo $ISOLINUXDIR/
cp ./ks.cfg $ISOLINUXDIR/ks
cp -f ./isolinux.cfg $ISOLINUXDIR/isolinux

yumdownloader --destdir=$ISOLINUXDIR/Packages --resolve policycoreutils centos-release selinux-policy filesystem libdaemon tzdata qrencode-libs bind-license device-mapper linux-firmware cryptsetup-libs nss-softokn-freebl kmod glibc dbus ncurses-libs polkit-pkla-compat libsepol iputils libselinux device-mapper-event-libs info wpa_supplicant xz-libs hwdata bzip2-libs cronie-anacron nspr libpciaccess libcom_err plymouth-scripts nss-util mesa-libgbm freetype grub2-tools expat device-mapper-event libgcrypt dnsmasq dbus-libs trousers audit-libs glib-networking elfutils-libelf net-tools libffi ppp glib2 fxload libattr alsa-tools-firmware libcap libthai which libtiff glibmm24 vim-filesystem elfutils-libs libX11-common lua libXext diffutils libXfixes atk libXdamage libidn libXinerama file-libs libXtst gdbm libXft perl-HTTP-Tiny mesa-libGL perl-Pod-Perldoc cairo perl-Text-ParseWords cairomm perl-Pod-Usage libXcomposite perl-libs gtkmm24 perl-Storable firewalld perl-Time-HiRes vim-enhanced perl-Time-Local rsyslog perl-threads-shared NetworkManager-wifi perl-Socket lvm2 perl-File-Temp grub2 perl-PathTools mlocate perl-Getopt-Long audit pciutils-libs irqbalance hostname biosdevname libmnl chrony atkmm parted libnl3-cli openssh-clients libcroco iprutils libassuan kernel-tools kmod-libs passwd libunistring mesa-libglapi btrfs-progs libicu libsysfs p11-kit-trust slang fuse-libs libnfnetlink lzo keyutils-libs libnetfilter_conntrack iproute libteam ipset nettle fuse acl gsettings-desktop-schemas avahi-libs cyrus-sasl-lib pinentry mozjs17 GeoIP ncurses graphite2 libmodman snappy krb5-libs coreutils python-libs gzip cracklib dbus-python libpwquality systemd-libs procps-ng pygobject3-base logrotate plymouth-core-libs python-configobj libselinux-python python-slip-dbus python-six python-perf newt-python binutils openssl nss-sysinit nss-tools bind-libs-lite fipscheck libssh2 curl rpm dhcp-libs dhcp-common openscap-scanner python-urlgrabber hardlink gnupg2 pygpgme rpm-python yum libdnet numactl-libs libaio libpipeline json-c libXau ustr shadow-utils util-linux libgcc openssh setup virt-what basesystem teamd kbd-legacy kpartx fontpackages-filesystem device-mapper-libs ncurses-base dracut glibc-common systemd libstdc++ polkit bash systemd-sysv pcre initscripts zlib dhclient sed os-prober grep crontabs popt cronie libuuid libdrm chkconfig plymouth libxml2 pciutils libdb dracut-network libgpg-error lvm2-libs readline ebtables libcap-ng gnutls gawk libsoup libsigc++20 open-vm-tools pkgconfig NetworkManager shared-mime-info alsa-firmware libacl libestr cpio jbigkit-libs libnl3 kbd-misc p11-kit vim-common sqlite libX11 findutils libXrender jansson libXi groff-base libXrandr libpng gdk-pixbuf2 gmp libXcursor perl-parent libXxf86vm perl-podlators mesa-libEGL perl-Pod-Escapes pango perl-Encode pangomm perl-macros gtk2 perl-threads firewalld-filesystem perl-Exporter open-vm-tools-desktop perl-Filter kbd perl-constant NetworkManager-tui perl-Scalar-List-Utils NetworkManager-team perl-Carp kexec-tools perl-File-Path rdma perl-Pod-Simple kernel perl tuned libjpeg-turbo openssh-server libpcap microcode_ctl file dracut-config-rescue nss-softokn selinux-policy-targeted tar authconfig libxslt man-db e2fsprogs-libs scap-security-guide xz sudo libgomp xfsprogs libedit e2fsprogs libtasn1 rootfiles ca-certificates newt sysvinit-tools tcp_wrappers-libs libxshmfence ethtool iptables gettext-libs ipset-libs jasper-libs less vim-minimal gobject-introspection dbus-glib libdb-utils xml-common libss make libselinux-utils gpm-libs harfbuzz libproxy libverto openssl-libs libblkid python fontconfig python-decorator cracklib-dicts pam libgudev1 gettext libmount centos-logos python-pyudev yum-metadata-parser pyliblzma python-slip python-firewall pyxattr python-iniparse grubby alsa-lib nss NetworkManager-libnm hicolor-icon-theme fipscheck-lib cups-libs libcurl rpm-libs openldap libuser openscap python-pycurl pixman pth gpgme rpm-build-libs yum-plugin-fastestmirror dmidecode kernel-tools-libs libndp device-mapper-persistent-data lsscsi libmspack libxcb libsemanage libutempter

