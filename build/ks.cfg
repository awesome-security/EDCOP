#version=DEVEL
# System authorization information
auth --enableshadow --passalgo=sha512
# Use CDROM installation media
install
cdrom
# Use cmdline install
cmdline
# Run the Setup Agent on first boot
#firstboot --enable
#ignoredisk --only-use=sda

# Keyboard layouts
keyboard --vckeymap=us --xlayouts='us'
# System language
lang en_US.UTF-8

zerombr
firewall --enabled --port=22:tcp
selinux --permissive
reboot

# Network information
#network  --bootproto=dhcp --device=eno16777736 --ipv6=auto --activate
#network --device=eth0 --bootproto=dhcp --ipv6=auto --activate
#network --device=eth1 --bootproto=dhcp --ipv6=auto --activate
network  --device=lo --hostname=EDCOP

# Root password
rootpw --plaintext open.local.box
# System timezone
timezone America/New_York --isUtc
# System bootloader configuration
clearpart --all --initlabel --drives=sda
bootloader --append=" crashkernel=auto biosdevname=0 net.ifnames=0" --location=mbr --boot-drive=sda
#autopart --type=lvm
part /boot --size=200 --fstype=xfs --asprimary
part swap --fstype=swap --recommended --asprimary
part pv.os --size=3000 --fstype=xfs --grow --asprimary

volgroup vg00 pv.os
logvol /              --vgname=vg00 --name=root  --fstype=xfs --size 5500 --maxsize 21000 --grow
logvol /var           --vgname=vg00 --name=var   --fstype=xfs --size 4000 --grow
logvol /home          --vgname=vg00 --name=home  --fstype=xfs --size 1000 --grow
logvol /var/log       --vgname=vg00 --name=log   --fstype=xfs --size 1500 --maxsize 25000 --grow
logvol /var/log/audit --vgname=vg00 --name=audit --fstype=xfs --size 1500 --maxsize 25000 --grow
logvol /tmp           --vgname=vg00 --name=tmp   --fstype=xfs --size 100 --maxsize 6000  --grow

%packages --excludedocs
@^minimal
@core
kexec-tools
openscap
openscap-scanner
scap-security-guide
#EDCOP specific packages
#dpdk-stable-devel
dpdk-stable
dpdk-stable-devel
openvswitch
openvswitch-devel
python-six
vim-enhanced
mlocate
net-tools
open-vm-tools
-aic94xx-firmware
-iwl6000-firmware
-iwl6050-firmware
-iwl7265-firmware
-iwl4965-firmware
-iwl6000g2b-firmware
-iwl105-firmware
-iwl1000-firmware
-iwl135-firmware
-iwl100-firmware
-iwl3945-firmware
-iwl3160-firmware
-iwl2030-firmware
-iwl5000-firmware
-iwl6000g2a-firmware
-ivtv-firmware
-iwl2000-firmware
-iwl5150-firmware
-iwl7260-firmware
-postfix

%end

#%addon org_fedora_oscap
#    content-type = scap-security-guide
#    profile = stig-rhel7-server-upstream
#%end

%addon com_redhat_kdump --enable --reserve-mb='auto'

%end


%post --log=/root/guardshark_post.log
systemctl enable openvswitch
ovs-vsctl --no-wait set Open_vSwitch . other_config:dpdk-init=true
%end

#%post --nochroot
#You can copy files from the disk over to the install directory e.g.
#cp /run/install/repo/EXTRAS/Certificates_PKCS7_v5.0u1_DoD.pem /mnt/isysimage/etc/pki/tls/certs/ca.crt
#cp -f /run/install/repo/EXTRAS/dump.pm2 /mnt/sysimage/root/.pm2/dump.pm2
#%end
